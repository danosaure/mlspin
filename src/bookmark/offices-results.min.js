(()=>{const e="body.mls-desktop:not(.mls-jq-modal-open)",t=".mls-js-ros-results-grid tbody tr",o="button.mls-js-ros-dtl-link",l=".mls-ros-detail-fld-lbl + a .mls-ros-dtl-office-info-div span",n=".mls-ros-dtl-tbl .mls-ros-dtl-agent-alt-row",s=".mls-ros-dtl-office-names,.mls-ros-dtl-office-contact-names",a=".mls-ros-dtl-office-phone-col .mls-phone-non-mobile",i=".mls-dtl-mail-to",r=e=>$(e).text().trim(),d=(e,t)=>r(t),m=window.open("","_blank"),f=$(e),c=e=>m.document.write(e);c("<pre>");c(`${["agent.id","agent.email","agent.name","agent.phone","office.id","office.name","office.address","office.city","office.state","office.zip","agent.role"].join(";")}\n`);const p=$(t);let g=p.length;p.map(((e,t)=>{const p=$(o,t),h=p.data("office-id"),b=r(p),j=((e,t)=>{const o=`tmpIframeOfficeId${t}`,l=`/MLS.Pinergy.Roster/Details?showInModal=true&officeId=${t}`;return e.append(`<iframe id="${o}" style="display:none" src="${l}"></iframe>`),$(`#${o}`)})(f,h);j.load((()=>{const e=j.contents(),t=$(l,e).map(d).get(),o=t.slice(0,t.length-1).join(", "),f=t[t.length-1],[p,u]=(f||"").split(" - "),[y,w]=(p||"").split(", "),I=$(n,e).map(((e,t,o,l,n,d)=>(m,f)=>[$(s,f).parent().attr("href").replace(/^.*agentId=/,"").replace(/&.*/,""),$(i,f).attr("data-mailto").replace("mailto:","").trim(),r($(s,f)),r($(a,f)),e,t,o,l,n,d,r($(f).parents("table").find("thead th"))].join(";"))(h,b,o,y,w,u)).get();I.length&&c(`${I.join("\n")}\n`),j.remove(),g--,0===g&&(c("</pre>"),m.document.close())}))}))})();
